function ajax(e,n){console.log(e),$.get(e,function(e){$("body").html(e),n&&n()})}function main(e){body=document.getElementsByTagName("body")[0],load(function(){config.minecraft||(config.minecraft={},save()),config.users||(config.users={},save()),config.packs||(config.packs=[],save()),config.minecraft.accessToken?launch(e):loadLogin(e)})}function loadLogin(e){ajax("views/login.html",function(){if(config.users!={}){var n=!0;for(var o in config.users){var c=config.users[o];n?($("#profiles").append("<label class='active'><input type='radio' onchange='checkSelected()' name='profile' value='"+o+"' checked>"+c.name+"</label>"),n=!1):$("#profiles").append("<label><input type='radio' onchange='checkSelected()' name='profile' value='"+o+"'>"+c.name+"</label>")}}e&&e()})}function launch(e){checkAccessToken(function(n){n?ajax("views/main.html",e):loadLogin(e)})}function checkAccessToken(e){request.post({url:"https://authserver.mojang.com/validate",json:{accessToken:config.minecraft.accessToken}},function(n,o){204!=o.statusCode&&(config.minecraft={}),e&&e(204==o.statusCode)})}function getProfiles(){var e=[];for(var n in config.users)e.push(n);return e}function selectProfile(e){config.users[e]&&(config.minecraft=config.users[e]),save()}function logout(){request.post({url:"https://authserver.mojang.com/invalidate",json:{agent:{name:"Minecraft",version:1},accessToken:config.minecraft.accessToken,clientToken:config.minecraft.clientToken}},function(){loadLogin()})}function generateAccessToken(e,n,o,c){request.post({url:"https://authserver.mojang.com/authenticate",json:{agent:{name:"Minecraft",version:1},username:n,password:o}},function(i,s,t){return t?t.error?void(c&&c(!1)):(config.users[t.selectedProfile.id]={name:t.selectedProfile.name,uuid:t.selectedProfile.id,accessToken:t.accessToken,clientToken:t.clientToken,username:n,password:o,legacy:t.selectedProfile.legacy},e||(config.users[t.selectedProfile.id].password=""),config.minecraft=config.users[t.selectedProfile.id],save(),void(c&&c(!0))):c(!1)})}function load(e){fs.existsSync("config.json")||fs.writeFileSync("config.json","{}"),fs.readFile("config.json",function(n,o){if(n)throw n;config=JSON.parse(o),e&&e()})}function save(){fs.writeFile("config.json",JSON.stringify(config,null,"	"),function(e){if(e)throw e})}var fs=require("fs"),path=require("path"),request=require("request"),config={},body;window.ondragover=function(e){return e.preventDefault(),!1},window.ondrop=function(e){return e.preventDefault(),!1},"true"!=require("nw.gui").App.argv[0]&&process.chdir(path.dirname(process.execPath));